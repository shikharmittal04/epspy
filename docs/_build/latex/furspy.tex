%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{furspy}
\date{Mar 10, 2024}
\release{}
\author{Shikhar Mittal}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxstepscope


\chapter{Basics}
\label{\detokenize{basics:basics}}\label{\detokenize{basics::doc}}

\section{Overview}
\label{\detokenize{basics:overview}}\begin{quote}\begin{description}
\sphinxlineitem{Name}
\sphinxAtStartPar
Foregrounds due to Unresolved Radio Sources

\sphinxlineitem{Author}
\sphinxAtStartPar
Shikhar Mittal

\sphinxlineitem{Homepage}
\sphinxAtStartPar
\sphinxurl{https://github.com/shikharmittal04/furs}

\end{description}\end{quote}


\section{Why do you need this code?}
\label{\detokenize{basics:why-do-you-need-this-code}}
\sphinxAtStartPar
Use this code to generate the Foregrounds due to Unresolved Radio Sources (FURS).

\sphinxAtStartPar
A cosmological global 21\sphinxhyphen{}cm signal hides under foregrounds due to galactic and extragalactic emissions. These foregrounds can easily be 4 to 5 orders of magnitude higher than the signal of interest. For a reliable inference it is important to accurately model these foregrounds. While we have a reasonable understanding of galactic emission (typically fit as log\sphinxhyphen{}log polynomial), we do not understand the extragalactic contributions. Based on existing models, this code models the foregrounds due to unresolved extragalactic radio sources.

\sphinxAtStartPar
Read more about it in the paper \sphinxhref{https://arxiv.org/abs/2311.03447}{Mittal et al (2024)}.


\section{Installation and requirements}
\label{\detokenize{basics:installation-and-requirements}}
\sphinxAtStartPar
This package can be installed as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip\PYG{+w}{ }install\PYG{+w}{ }furspy
\end{sphinxVerbatim}

\sphinxAtStartPar
It is recommended to work on a Python version \textgreater{} 3.8. Packages required are
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/numpy/}{numpy}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/scipy/}{scipy}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/matplotlib/}{matplotlib}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/mpi4py/}{mpi4py}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/healpy/}{healpy}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/transformcl/}{transformcl}

\end{itemize}


\section{Quick start}
\label{\detokenize{basics:quick-start}}
\sphinxAtStartPar
The code is run in two main steps:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Assign the unresolved sources flux densities (at a chosen reference frequency) and spectral indices.

\item {} 
\sphinxAtStartPar
Then generate the sky maps at desired frequencies of observation.

\end{itemize}

\sphinxAtStartPar
The following code captures the main functionalities of this package.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}1 initialise the object with default settings}
\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}2 generate the data at the reference frequency}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{ref\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}3 generate the sky maps at multiple frequencies as well as their sky average}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{gen\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}4 finally, generate a sky averaged spectrum vs frequency figure}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{visual}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Save the above code as (say) \sphinxcode{\sphinxupquote{eg\_script.py}} and run it as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }eg\PYGZus{}script.py
\end{sphinxVerbatim}

\sphinxAtStartPar
Running the code will generate several files. The terminal messages will
guide you to these output files. The most important of all files of your
interest will be \sphinxcode{\sphinxupquote{Tb\_nu\_map.npy}}. However, you may never have to deal
with them yourself. To visualise your outputs use the function
\sphinxcode{\sphinxupquote{visual()}}. See {\hyperref[\detokenize{api:api}]{\sphinxcrossref{\DUrole{std,std-ref}{API Reference}}}} for the available features for \sphinxcode{\sphinxupquote{visual()}}.

\sphinxAtStartPar
The default values have been chosen such that the above script can be
run on a PC. Since modern PCs have at least 4 cores, for a better
performance one could also run the code as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
mpirun\PYG{+w}{ }\PYGZhy{}np\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }python\PYG{+w}{ }eg\PYGZus{}script.py
\end{sphinxVerbatim}

\sphinxAtStartPar
However, in general and for more realistic flux density ranges and high
resolution maps, it is recommended to run the code on HPCs.


\section{License and citation}
\label{\detokenize{basics:license-and-citation}}
\sphinxAtStartPar
The software is free to use on the MIT open source license. If you use the software then please consider citing \sphinxhref{https://arxiv.org/abs/2311.03447}{Mittal et al (2024)}.

\sphinxstepscope


\chapter{Detailed explanation}
\label{\detokenize{detexp:detailed-explanation}}\label{\detokenize{detexp::doc}}

\section{Initialisation}
\label{\detokenize{detexp:initialisation}}
\sphinxAtStartPar
The first step to use this package is to initialise the properties of the unresolved sources. This is done using the class
{\hyperref[\detokenize{api:furs.furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs.furs}}}}}. If you give no arguments default settings are assumed.

\sphinxAtStartPar
There are total 11 available optional arguments. See the {\hyperref[\detokenize{api:api}]{\sphinxcrossref{\DUrole{std,std-ref}{API Reference}}}}. If you want to chose a different set of parameters, then your python script should have the following initialisation

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}
\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{n}{log2Nside}\PYG{o}{=}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{logSmin}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{logSmax}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{dndS\PYGZus{}form}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{nu\PYGZus{}o}\PYG{o}{=}\PYG{l+m+mf}{150e6}\PYG{p}{,} \PYG{n}{beta\PYGZus{}o}\PYG{o}{=}\PYG{l+m+mf}{2.681}\PYG{p}{,}\PYG{n}{sigma\PYGZus{}beta}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n}{amp}\PYG{o}{=}\PYG{l+m+mf}{7.8e\PYGZhy{}3}\PYG{p}{,}\PYG{n}{gam}\PYG{o}{=}\PYG{l+m+mf}{0.821}\PYG{p}{,} \PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{lbl}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
(Replace the above values by values of your choice.)


\section{Reference frequency}
\label{\detokenize{detexp:reference-frequency}}\label{\detokenize{detexp:ref-freq}}
\sphinxAtStartPar
The function \sphinxcode{\sphinxupquote{ref\_freq()}} does 3 tasks:\sphinxhyphen{}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Calcuates the total number of unresolved sources corresponding to your specified \sphinxcode{\sphinxupquote{logSmin}} and \sphinxcode{\sphinxupquote{logSmin}}. Then it creates a ‘clustered’ sky density of unresolved radio sources, fluctuation for which follows the 2PACF whose parameters are set by \sphinxcode{\sphinxupquote{amp}} and \sphinxcode{\sphinxupquote{gam}}.

\item {} 
\sphinxAtStartPar
Next, it visits each pixel on the sky and assigns each source a flux density chosen from a flux distribution function, \(\mathrm{d}n/\mathrm{d}S\)

\item {} 
\sphinxAtStartPar
Finally, it assigns a spectral index to each source which is normally distributed. The normal distribution is set by \sphinxcode{\sphinxupquote{beta\_o}} and \sphinxcode{\sphinxupquote{sigma\_beta}}.

\end{enumerate}

\sphinxAtStartPar
Sky pixelisation is set by \sphinxcode{\sphinxupquote{log2Nside}}. The number of pixels is \(N_{\mathrm{pix}} = 12\times 2^{2k}\), where \(k=\) \sphinxcode{\sphinxupquote{log2Nside}}.

\sphinxAtStartPar
The function does not return anything, but produces 4 output files, namely \sphinxcode{\sphinxupquote{n\_clus.npy}}, \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}}, \sphinxcode{\sphinxupquote{Tb\_o\_map.npy}}, and \sphinxcode{\sphinxupquote{beta.npy}} in the path specified by \sphinxcode{\sphinxupquote{path}} during initialisation. The files are described below.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{n\_clus.npy}} is a 1D array which stores number density of unresolved radio sources as number per pixel. \sphinxcode{\sphinxupquote{n\_clus{[}i{]}}} gives the number of sources on the \(i^{\mathrm{th}}\) pixel, where \(i=0,1,\ldots,N_{\mathrm{pix}}-1\). Note that in general \sphinxcode{\sphinxupquote{n\_clus{[}i{]}}} will not be a natural number; we simulate for a rounded\sphinxhyphen{}off value.

\item {} 
\sphinxAtStartPar
Both \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}} and \sphinxcode{\sphinxupquote{beta.npy}} are array of arrays of unequal sizes and share equal amount of memory. Typically, these files will be huge (for default settings they will of size \textasciitilde{} 17 MB each). Each of \sphinxcode{\sphinxupquote{Tb\_o\_individual{[}0{]}}}, \sphinxcode{\sphinxupquote{Tb\_o\_individual{[}1{]}}}, …, is an array and they are total \(N_{\mathrm{pix}}\) in number corresponding to \(N_{\mathrm{pix}}\) pixels. The last array is \sphinxcode{\sphinxupquote{Tb\_o\_individual{[}Npix\sphinxhyphen{}1{]}}}. The length of array \sphinxcode{\sphinxupquote{Tb\_o\_individual{[}i{]}}} is equal to the number of sources on the \(i^{\mathrm{th}}\) pixel, which is \sphinxcode{\sphinxupquote{round(n\_clus{[}i{]})}}. The values itself are the brightness temperature contributed by each source in kelvin at reference frequency. Note that \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}} and \sphinxcode{\sphinxupquote{beta.npy}} are ‘Object’ arrays. If you want to load them yourself then set \sphinxcode{\sphinxupquote{allow\_pickle=True}} in \sphinxcode{\sphinxupquote{numpy.load()}}

\item {} 
\sphinxAtStartPar
The structure of \sphinxcode{\sphinxupquote{beta}} is same as \sphinxcode{\sphinxupquote{Tb\_o\_individual}}. The values itself are the spectral indices assigned to each source.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_o\_map}} is an array similar in structure to \sphinxcode{\sphinxupquote{n\_clus}}. It is the pixel wise brightness temperature contributed by the extragalactic radio sources at the reference frequency. Thus, \sphinxcode{\sphinxupquote{Tb\_o\_map{[}i{]} = numpy.sum(Tb\_o\_individual{[}i{]})}}.

\end{itemize}

\sphinxAtStartPar
The following should be your python script

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{ref\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\section{General frequency}
\label{\detokenize{detexp:general-frequency}}\label{\detokenize{detexp:gen-freq}}
\sphinxAtStartPar
The next important task is performed by the function \sphinxcode{\sphinxupquote{gen\_freq()}}. It scales the brightness temperature at reference frequency for each source according to a power law to a desired range of frequencies. The desired frequencies should be supplied (in Hz) as a \sphinxcode{\sphinxupquote{numpy}} array to this function. For example the following should be your python script

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{ref\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{gen\PYGZus{}freq}\PYG{p}{(}\PYG{n}{nu} \PYG{o}{=} \PYG{l+m+mf}{1e6}\PYG{o}{*}\PYG{n}{numpy}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+m+mi}{201}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The default value of frequencies at which \sphinxcode{\sphinxupquote{gen\_freq()}} will scale is \(\nu=50,51,\ldots,200\,\) MHz. This function does not return anything but produces 3 files namely \sphinxcode{\sphinxupquote{Tb\_nu\_map.npy}}, \sphinxcode{\sphinxupquote{Tb\_nu\_glob.npy}}, and \sphinxcode{\sphinxupquote{nu\_glob.npy}} in the path specified by \sphinxcode{\sphinxupquote{path}} during initialisation. The files are described below.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_nu\_map}} is a 2D array of shape \(N_{\mathrm{pix}}\times N_{\nu}\), so that \sphinxcode{\sphinxupquote{Tb\_nu\_map{[}i,k{]}}} gives the brightness temperature on the \(i^{\mathrm{th}}\) pixel at \sphinxcode{\sphinxupquote{nu{[}k{]}}} frequency. \(N_{\nu}\) is the number of frequencies you gave in the argument of \sphinxcode{\sphinxupquote{gen\_freq()}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_nu\_glob}} is derived directly from \sphinxcode{\sphinxupquote{Tb\_nu\_map}}. It is the sky average of the map at each frequency and is thus a 1D array. It is calculated as \sphinxcode{\sphinxupquote{Tb\_nu\_glob = numpy.mean(Tb\_nu\_map,axis=0)}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nu\_glob.npy}} is simply the frequency array you gave else it is the default value.

\end{enumerate}

\sphinxAtStartPar
Note that this function loads \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}} and \sphinxcode{\sphinxupquote{beta.npy}}. These files can easily be 10s of GB in size for ‘realistic’ \sphinxcode{\sphinxupquote{logSmin}} and \sphinxcode{\sphinxupquote{logSmax}}. Common personal computers have \textasciitilde{} 4 GB RAM. It is thus recommended to run this code on supercomputers. For job submission scipt users are requested to specify \sphinxcode{\sphinxupquote{\#SBATCH \sphinxhyphen{}\sphinxhyphen{}mem\sphinxhyphen{}per\sphinxhyphen{}cpu={[}size in MB{]}}},
where a recommendation for \sphinxcode{\sphinxupquote{size in MB}} will be printed by \sphinxcode{\sphinxupquote{ref\_freq()}} function.


\section{Chromatic distortions}
\label{\detokenize{detexp:chromatic-distortions}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_nu\_map}} and hence \sphinxcode{\sphinxupquote{Tb\_nu\_glob}} so generated do NOT account for chromatic distortions. They are simply the model outputs for foregrounds due to unresolved radio sources. However, in reality because of the chromatic nature of the antenna beam the actual foregrounds spectrum registered will be different. You can use the function \sphinxcode{\sphinxupquote{couple2D()}} to account for the chromaticity. It essentially couples the foregrounds to the beam directivity.

\sphinxAtStartPar
Since this is experiment specific you will need to provide an external data file: the beam directivity pattern, \(D\). This should be a 2D array of shape \(N_{\mathrm{pix}}\times N_{\nu}\), such that \sphinxcode{\sphinxupquote{D{[}i,k{]}}} should give the beam directivity at \(i^{\mathrm{th}}\) pixel at \sphinxcode{\sphinxupquote{nu{[}k{]}}} frequency. The frequencies at which you generate your data \(D\) should be the same as the frequencies you gave in \sphinxcode{\sphinxupquote{gen\_freq()}}. (In case you forgot, \sphinxcode{\sphinxupquote{gen\_freq()}} will have saved the frequency array in your \sphinxcode{\sphinxupquote{obj.path}} path.) Put this array \(D\) in your \sphinxcode{\sphinxupquote{obj.path}} path by the name of
\sphinxcode{\sphinxupquote{D.npy}}.

\sphinxAtStartPar
Only after running \sphinxcode{\sphinxupquote{ref\_freq()}} and \sphinxcode{\sphinxupquote{gen\_freq()}}, run \sphinxcode{\sphinxupquote{couple2D()}} as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{ref\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{gen\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}If you have already ran ref\PYGZus{}freq and gen\PYGZus{}freq previously then comment}
\PYG{c+c1}{\PYGZsh{}obj.ref\PYGZus{}freq() and obj.gen\PYGZus{}freq().}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{couple2D}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
No input argument is required. The return value is \sphinxcode{\sphinxupquote{None}}. This function will generate a file called \sphinxcode{\sphinxupquote{T\_ant.npy}} in your path. This will be a 1D array with length of number of frequencies.

\sphinxAtStartPar
This function will also print the best\sphinxhyphen{}fitting parameters (along with \(1\sigma\) uncertainty) \(T_{\mathrm{f}}, \beta_{\mathrm{f}}\) and \(\Delta\beta_{\mathrm{f}}\) based on a simple least\sphinxhyphen{}squares fitting of power\sphinxhyphen{}law\sphinxhyphen{}with\sphinxhyphen{}a\sphinxhyphen{}running\sphinxhyphen{}spectral\sphinxhyphen{}index function as follows
\begin{equation*}
\begin{split}T_{\mathrm{f}}\left(\frac{\nu}{\nu_0}\right)^{(-\beta_{\mathrm{f}}\,+\,\Delta\beta_{\mathrm{f}}\,\ln{\nu/\nu_0})}\end{split}
\end{equation*}
\sphinxAtStartPar
to the antenna temperature data.


\section{Visualisation}
\label{\detokenize{detexp:visualisation}}
\sphinxAtStartPar
The final part of the code is to visualise the results. Main data for inspection is in the file \sphinxcode{\sphinxupquote{Tb\_nu\_map.npy}}. Each of \sphinxcode{\sphinxupquote{Tb\_nu\_map{[}:,k{]}}} is an array in the standard ring ordered \sphinxcode{\sphinxupquote{HEALPix}} format and is thus ready for visualisation as a Mollweide projection. You may also be interested in inspecting the global spectrum of extragalactic emission, i.e, temperature as a function of frequency. This is simply the data in the file \sphinxcode{\sphinxupquote{Tb\_nu\_glob.npy}} generated by \sphinxcode{\sphinxupquote{gen\_freq()}}.

\sphinxAtStartPar
You may use the function \sphinxcode{\sphinxupquote{visual()}} for both the above purposes. It is possible to make several other additional figures by simply setting the optional arguments to \sphinxcode{\sphinxupquote{True}} (see below). This function is again a method of class object {\hyperref[\detokenize{api:furs.furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs.furs}}}}} and is thus your python script should contain

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{ref\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{gen\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{obj}\PYG{o}{.}\PYG{n}{couple2D}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}comment out obj.ref\PYGZus{}freq(), obj.gen\PYGZus{}freq(), obj.couple2D() if you have already run them.}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{visual}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
For all the available options for this function see the {\hyperref[\detokenize{api:api}]{\sphinxcrossref{\DUrole{std,std-ref}{API Reference}}}}. This function will produce figures in the path specficied during initialisation.

\sphinxstepscope


\chapter{Other functions}
\label{\detokenize{otherfuncs:other-functions}}\label{\detokenize{otherfuncs::doc}}
\sphinxAtStartPar
The main functionality of the package was already discussed in previous sections. Here we will learn about 5 additional useful methods of the class {\hyperref[\detokenize{api:furs.furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs.furs}}}}}. These are
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
The 2\sphinxhyphen{}point angular correlation function (2PACF, \(C=C(\chi)\)), \sphinxcode{\sphinxupquote{acf()}}

\item {} 
\sphinxAtStartPar
The flux density distribution function (\(\mathrm{d}n/\mathrm{d}S\)), \sphinxcode{\sphinxupquote{dndS()}}. As this function is a method of class {\hyperref[\detokenize{api:furs.furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs.furs}}}}}, the choice of the form of of \(\mathrm{d}n/\mathrm{d}S\) will have been set when you initialise your class {\hyperref[\detokenize{api:furs.furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs.furs}}}}} object as

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furpy} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
Total number of sources on the full sky ( \(N_{\mathrm{s}}\) ), \sphinxcode{\sphinxupquote{num\_sources()}}. This  function has direct correspondence with the form of \(\mathrm{d}n/\mathrm{d}S\).

\item {} 
\sphinxAtStartPar
Number of source per pixel ( \(n_{\mathrm{cl}}\) ), \sphinxcode{\sphinxupquote{num\_den()}}. As in the \sphinxcode{\sphinxupquote{num\_sources()}}, the total number density returned will correspond to the chosen form of \(\mathrm{d}n/\mathrm{d}S\).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{print\_input()}} can be useful if you want see what parameters you are currently running with.

\end{enumerate}

\sphinxAtStartPar
Note that these functions are computationally cheap and thus can be run directly in a jupyter notebook or interactively on the terminal.

\sphinxAtStartPar
\sphinxstylestrong{Examples}

\sphinxAtStartPar
Suppose you want to find the number of sources between \(S=10^{-6}\) and \(10^{-1}\mathrm{Jy}\) for a \(7^{\mathrm{th}}\) order log\sphinxhyphen{}log polynomial fit to Euclidean number count then do

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{n}{dndS\PYGZus{}form}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{logSmin}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{n}{logSmax}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{Ns} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{num\PYGZus{}sources}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{Ns}
\PYG{g+go}{249825819.67727068}
\end{sphinxVerbatim}

\sphinxAtStartPar
Let us calculate the number density.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ncl} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{num\PYGZus{}den}\PYG{p}{(}\PYG{p}{)}
\PYG{g+go}{Total number of sources, Ns = 249825820}
\PYG{g+go}{Total number of pixels, Npix = 49152}
\PYG{g+go}{Average number of sources per pixel, n\PYGZus{}bar = 5082.72}
\PYG{g+go}{Done.}
\PYG{g+go}{Average overdensity for the clustered sky (should be \PYGZti{} 0) = 0.007}
\PYG{g+go}{The clustered number density has been saved into file:}
\PYG{g+go}{ n\PYGZus{}clus}
\end{sphinxVerbatim}

\sphinxAtStartPar
(Note that since this is a random process you might get different numbers.)

\sphinxAtStartPar
Let us also check if the sum of the elements of array \sphinxcode{\sphinxupquote{ncl}} is \sphinxcode{\sphinxupquote{Ns}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ncl}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{)}
\PYG{g+go}{251605169.7207427}
\end{sphinxVerbatim}

\sphinxAtStartPar
There some discrepancy but do not be worried as this is just a numerical artefact. In fact the fractional error is already printed and is about 0.7\%, which is sufficiently small.

\sphinxstepscope


\chapter{General remarks}
\label{\detokenize{genrem:general-remarks}}\label{\detokenize{genrem::doc}}
\sphinxAtStartPar
Users do not have to run \sphinxcode{\sphinxupquote{ref\_freq()}} everytime. If they want to use the same data for source distribution (\sphinxcode{\sphinxupquote{n\_clus.npy}}), flux density (\sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}}) and spectral index (\sphinxcode{\sphinxupquote{beta.npy}}) assignments at reference frequency to generate spectrum and sky maps for a different frequency range, then run only \sphinxcode{\sphinxupquote{gen\_freq()}} for a new choice of \sphinxcode{\sphinxupquote{nu}}.

\sphinxAtStartPar
Similarly, if you have already run \sphinxcode{\sphinxupquote{gen\_freq()}} and are happy with the specifications of the model then you can directly jump to the \sphinxcode{\sphinxupquote{visual()}} function.

\sphinxAtStartPar
In case you forgot what data set you generated with what parameter specifications, you can always save your class object using the function \sphinxcode{\sphinxupquote{save\_furs()}} in the directory where all other outputs are saved and load back using \sphinxcode{\sphinxupquote{load\_furs()}}. (Both functions are part of module \sphinxcode{\sphinxupquote{furs.py}}.)

\sphinxAtStartPar
Thus, after initialising your class object (i.e. \sphinxcode{\sphinxupquote{obj = furs.furs({[}YOUR SPECIFICATIONS{]})}}), you can add to your script \sphinxcode{\sphinxupquote{furs.save\_furs(obj,\textquotesingle{}myobj\textquotesingle{})}}.

\sphinxAtStartPar
\sphinxstylestrong{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{furs}\PYG{o}{.}\PYG{n}{save\PYGZus{}furs}\PYG{p}{(}\PYG{n}{obj}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{myobj}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
So when you came back next time you can load it as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}
\PYG{n}{obj}\PYG{o}{=}\PYG{n}{furs}\PYG{o}{.}\PYG{n}{load\PYGZus{}furs}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/give/full/path/to/myobj.pkl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Remember to give the full path to the \sphinxcode{\sphinxupquote{myobj}} with the extension \sphinxcode{\sphinxupquote{.pkl}}.

\sphinxAtStartPar
You may now check that indeed the specfications are correctly loaded by printing them using function \sphinxcode{\sphinxupquote{print\_input()}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furspy} \PYG{k+kn}{import} \PYG{n}{furs}
\PYG{n}{obj}\PYG{o}{=}\PYG{n}{furs}\PYG{o}{.}\PYG{n}{load\PYGZus{}furs}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/give/full/path/to/myobj.pkl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{print\PYGZus{}input}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{API Reference}
\label{\detokenize{api:module-furs}}\label{\detokenize{api:api-reference}}\label{\detokenize{api:api}}\label{\detokenize{api::doc}}\index{module@\spxentry{module}!furs@\spxentry{furs}}\index{furs@\spxentry{furs}!module@\spxentry{module}}
\sphinxAtStartPar
This is the module {\hyperref[\detokenize{api:module-furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs}}}}}.
It contains public functions {\hyperref[\detokenize{api:furs.save_furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{save\_furs()}}}}}, {\hyperref[\detokenize{api:furs.load_furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{load\_furs()}}}}} and a class {\hyperref[\detokenize{api:module-furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs}}}}}.
\index{save\_furs() (in module furs)@\spxentry{save\_furs()}\spxextra{in module furs}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.save_furs}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{furs.}}\sphinxbfcode{\sphinxupquote{save\_furs}}}{\sphinxparam{\DUrole{n}{obj}}\sphinxparamcomma \sphinxparam{\DUrole{n}{filename}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Saves the class object {\hyperref[\detokenize{api:module-furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs}}}}}.

\sphinxAtStartPar
Save the class object {\hyperref[\detokenize{api:module-furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs}}}}} for later use. It will save the object in the path where you have all the other outputs
form this package.


\section{Parameters}
\label{\detokenize{api:parameters}}\begin{description}
\sphinxlineitem{obj}{[}class{]}
\sphinxAtStartPar
This should be the class object you want to save.

\sphinxlineitem{filename}{[}str{]}
\sphinxAtStartPar
Give a filename to your object. It will be saved in the \sphinxcode{\sphinxupquote{obj.path}} directory.

\end{description}

\end{fulllineitems}

\index{load\_furs() (in module furs)@\spxentry{load\_furs()}\spxextra{in module furs}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.load_furs}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{furs.}}\sphinxbfcode{\sphinxupquote{load\_furs}}}{\sphinxparam{\DUrole{n}{filename}}}{}
\pysigstopsignatures
\sphinxAtStartPar
To load the class object {\hyperref[\detokenize{api:module-furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs}}}}}.


\section{Parameters}
\label{\detokenize{api:id1}}\begin{description}
\sphinxlineitem{filename}{[}str{]}
\sphinxAtStartPar
This should be the name of the file you gave in {\hyperref[\detokenize{api:furs.save_furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{save\_furs()}}}}} for saving class object {\hyperref[\detokenize{api:module-furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs}}}}}.
Important: provide the full path for \sphinxcode{\sphinxupquote{filename}} with the extension \sphinxcode{\sphinxupquote{.pkl}}.

\end{description}


\section{Returns}
\label{\detokenize{api:returns}}
\sphinxAtStartPar
class object

\end{fulllineitems}

\index{furs (class in furs)@\spxentry{furs}\spxextra{class in furs}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{furs.}}\sphinxbfcode{\sphinxupquote{furs}}}{\sphinxparam{\DUrole{n}{beta\_o}\DUrole{o}{=}\DUrole{default_value}{2.681}}\sphinxparamcomma \sphinxparam{\DUrole{n}{sigma\_beta}\DUrole{o}{=}\DUrole{default_value}{0.5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{logSmin}\DUrole{o}{=}\DUrole{default_value}{\sphinxhyphen{}2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{logSmax}\DUrole{o}{=}\DUrole{default_value}{\sphinxhyphen{}1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dndS\_form}\DUrole{o}{=}\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{log2Nside}\DUrole{o}{=}\DUrole{default_value}{6}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nu\_o}\DUrole{o}{=}\DUrole{default_value}{150000000.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{amp}\DUrole{o}{=}\DUrole{default_value}{0.0078}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gam}\DUrole{o}{=}\DUrole{default_value}{0.821}}\sphinxparamcomma \sphinxparam{\DUrole{n}{path}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lbl}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\textquotesingle{}}}}{}
\pysigstopsignatures
\sphinxAtStartPar
This is class for initialising the properties of the unresolved radio sources.


\section{Attributes}
\label{\detokenize{api:attributes}}\begin{description}
\sphinxlineitem{nu\_o}{[}float, optional{]}
\sphinxAtStartPar
Reference frequency in Hz

\sphinxlineitem{beta\_o}{[}float, optional{]}
\sphinxAtStartPar
Mean spectral index for extragalactic point sources

\sphinxlineitem{sigma\_beta}{[}float, optional{]}
\sphinxAtStartPar
Spread in the beta values

\sphinxlineitem{amp}{[}float, optional{]}
\sphinxAtStartPar
Amplitude of the power\sphinxhyphen{}law 2\sphinxhyphen{}point angular correlation function (2PACF)

\sphinxlineitem{gam}{[}float, optional{]}
\sphinxAtStartPar
\(-\) exponent of the power\sphinxhyphen{}law 2\sphinxhyphen{}point angular correlation function

\sphinxlineitem{logSmin}{[}float, optional{]}
\sphinxAtStartPar
\(\log_{10}(S_{\mathrm{min}})\), where \(S_{\mathrm{min}}\) is in Jy

\sphinxlineitem{logSmax}{[}float, optional{]}
\sphinxAtStartPar
\(\log_{10}(S_{\mathrm{max}})\), where \(S_{\mathrm{max}}\) is in Jy

\sphinxlineitem{dndS\_form}{[}int, optional{]}
\sphinxAtStartPar
Choose the functional form for \(\mathrm{d}n/\mathrm{d}S\). Available options \sphinxhyphen{}\textgreater{} 0 (default),1 or 2

\sphinxlineitem{log2Nside}{[}int, optional{]}
\sphinxAtStartPar
Number of divisions in units of \(\log_2\)

\sphinxlineitem{path}{[}str, optional{]}
\sphinxAtStartPar
Path where you would like to save and load from, the Tb’s and beta’s

\sphinxlineitem{lbl}{[}str, optional{]}
\sphinxAtStartPar
Append an extra string to all the output files.

\end{description}


\section{Methods}
\label{\detokenize{api:methods}}\index{acf() (furs.furs method)@\spxentry{acf()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.acf}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{acf}}}{\sphinxparam{\DUrole{n}{chi}}}{}
\pysigstopsignatures
\sphinxAtStartPar
2 point angular correlation function.

\sphinxAtStartPar
This is the popular form of the 2PACF; a power law.

\sphinxAtStartPar
The default values for amplitude and index are from \sphinxhref{https://academic.oup.com/mnras/article/485/4/5891/5420431}{Rana \& Bagla (2019)}.


\subsection{Parameters}
\label{\detokenize{api:id2}}\begin{description}
\sphinxlineitem{chi}{[}float{]}
\sphinxAtStartPar
Angle at which you want to get the 2PACF, should be in radians. One number or an array.

\end{description}


\subsection{Returns}
\label{\detokenize{api:id3}}\begin{description}
\sphinxlineitem{float}
\sphinxAtStartPar
Output is pure number or an array accordingly as \sphinxcode{\sphinxupquote{chi}} is a number or an array.

\end{description}

\end{fulllineitems}

\index{couple2D() (furs.furs method)@\spxentry{couple2D()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.couple2D}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{couple2D}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Couple the foregrounds generated by {\hyperref[\detokenize{api:furs.furs.gen_freq}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{gen\_freq()}}}}} to the antenna beam directivity.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_nu\_map.npy}} generated by {\hyperref[\detokenize{api:furs.furs.gen_freq}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{gen\_freq()}}}}} does not account for chromatic distortions in the antenna. To account for this users must provide an array, named \sphinxcode{\sphinxupquote{D.npy}}, which should be in the shape of \(N_{\mathrm{pix}} \times N_{\nu}\). Put this array into the path where you have all the other outputs. An output file will be generated called \sphinxcode{\sphinxupquote{T\_ant.npy}}.

\sphinxAtStartPar
Also, the best\sphinxhyphen{}fitting parameters (along with \(1\sigma\) uncertainty) \(T_{\mathrm{f}}, \beta_{\mathrm{f}}\) and \(\Delta\beta_{\mathrm{f}}\) based on a simple least\sphinxhyphen{}squares fitting of power\sphinxhyphen{}law\sphinxhyphen{}with\sphinxhyphen{}a\sphinxhyphen{}running\sphinxhyphen{}spectral\sphinxhyphen{}index function to the antenna temperature data will be printed.

\end{fulllineitems}

\index{dndS() (furs.furs method)@\spxentry{dndS()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.dndS}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dndS}}}{\sphinxparam{\DUrole{n}{S}}}{}
\pysigstopsignatures
\sphinxAtStartPar
\(\mathrm{d}n/\mathrm{d}S\,(\mathrm{sr}^{-1}\mathrm{Jy}^{-1})\)

\sphinxAtStartPar
Distribution of flux density, S.

\sphinxAtStartPar
The default choice (0) is by \sphinxhref{https://iopscience.iop.org/article/10.1086/588628/meta}{Gervasi et al (2008)}. It is approximately a power law. See paper for the exact form.

\sphinxAtStartPar
Form 1 is by \sphinxhref{https://www.aanda.org/articles/aa/full\_html/2021/04/aa39998-20/aa39998-20.html}{Mandal et al. (2021)}. It is a \(7^{\mathrm{th}}\) order log\sphinxhyphen{}log polynomial fit to the Euclidean number count.

\sphinxAtStartPar
Form 2 is by \sphinxhref{https://www.aanda.org/articles/aa/full\_html/2017/02/aa28536-16/aa28536-16.html}{Intema et al. (2017)}. It is a \(5^{\mathrm{th}}\) order log\sphinxhyphen{}log polynomial fit to the Euclidean number count.


\subsection{Parameters}
\label{\detokenize{api:id4}}\begin{description}
\sphinxlineitem{S}{[}float{]}
\sphinxAtStartPar
Flux density in units of Jy (jansky). Can be 1 value or an numpy array.

\end{description}


\subsection{Returns}
\label{\detokenize{api:id5}}\begin{description}
\sphinxlineitem{float}
\sphinxAtStartPar
Number of sources per unit solid angle per unit flux density. 1 value or an array depending on input.

\end{description}

\end{fulllineitems}

\index{gen\_freq() (furs.furs method)@\spxentry{gen\_freq()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.gen_freq}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{gen\_freq}}}{\sphinxparam{\DUrole{n}{nu}\DUrole{o}{=}\DUrole{default_value}{array({[}5.00e+07, 5.10e+07, 5.20e+07, 5.30e+07, 5.40e+07, 5.50e+07, 5.60e+07, 5.70e+07, 5.80e+07, 5.90e+07, 6.00e+07, 6.10e+07, 6.20e+07, 6.30e+07, 6.40e+07, 6.50e+07, 6.60e+07, 6.70e+07, 6.80e+07, 6.90e+07, 7.00e+07, 7.10e+07, 7.20e+07, 7.30e+07, 7.40e+07, 7.50e+07, 7.60e+07, 7.70e+07, 7.80e+07, 7.90e+07, 8.00e+07, 8.10e+07, 8.20e+07, 8.30e+07, 8.40e+07, 8.50e+07, 8.60e+07, 8.70e+07, 8.80e+07, 8.90e+07, 9.00e+07, 9.10e+07, 9.20e+07, 9.30e+07, 9.40e+07, 9.50e+07, 9.60e+07, 9.70e+07, 9.80e+07, 9.90e+07, 1.00e+08, 1.01e+08, 1.02e+08, 1.03e+08, 1.04e+08, 1.05e+08, 1.06e+08, 1.07e+08, 1.08e+08, 1.09e+08, 1.10e+08, 1.11e+08, 1.12e+08, 1.13e+08, 1.14e+08, 1.15e+08, 1.16e+08, 1.17e+08, 1.18e+08, 1.19e+08, 1.20e+08, 1.21e+08, 1.22e+08, 1.23e+08, 1.24e+08, 1.25e+08, 1.26e+08, 1.27e+08, 1.28e+08, 1.29e+08, 1.30e+08, 1.31e+08, 1.32e+08, 1.33e+08, 1.34e+08, 1.35e+08, 1.36e+08, 1.37e+08, 1.38e+08, 1.39e+08, 1.40e+08, 1.41e+08, 1.42e+08, 1.43e+08, 1.44e+08, 1.45e+08, 1.46e+08, 1.47e+08, 1.48e+08, 1.49e+08, 1.50e+08, 1.51e+08, 1.52e+08, 1.53e+08, 1.54e+08, 1.55e+08, 1.56e+08, 1.57e+08, 1.58e+08, 1.59e+08, 1.60e+08, 1.61e+08, 1.62e+08, 1.63e+08, 1.64e+08, 1.65e+08, 1.66e+08, 1.67e+08, 1.68e+08, 1.69e+08, 1.70e+08, 1.71e+08, 1.72e+08, 1.73e+08, 1.74e+08, 1.75e+08, 1.76e+08, 1.77e+08, 1.78e+08, 1.79e+08, 1.80e+08, 1.81e+08, 1.82e+08, 1.83e+08, 1.84e+08, 1.85e+08, 1.86e+08, 1.87e+08, 1.88e+08, 1.89e+08, 1.90e+08, 1.91e+08, 1.92e+08, 1.93e+08, 1.94e+08, 1.95e+08, 1.96e+08, 1.97e+08, 1.98e+08, 1.99e+08, 2.00e+08{]})}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Scale the brightness temperature at reference frequency to a general frequency.

\sphinxAtStartPar
If you are running this function you must have run {\hyperref[\detokenize{api:furs.furs.ref_freq}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ref\_freq()}}}}}.

\sphinxAtStartPar
This function computes the map(s) at general frequency(ies) based on the precomputed values from {\hyperref[\detokenize{api:furs.furs.ref_freq}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ref\_freq()}}}}}.


\subsection{Parameters}
\label{\detokenize{api:id6}}\begin{description}
\sphinxlineitem{nu}{[}float{]}
\sphinxAtStartPar
frequency (in Hz) at which you want to evaluate the brightness temperature map. Can be one number or an array.
(Default = \sphinxtitleref{1e6*np.arange(50,201)})

\end{description}

\sphinxAtStartPar
3 files will be generated namely, \sphinxcode{\sphinxupquote{Tb\_nu\_glob.npy}}, \sphinxcode{\sphinxupquote{Tb\_nu\_glob.npy}}, and \sphinxcode{\sphinxupquote{nu\_glob.npy}}.

\sphinxAtStartPar
To understand the structure of these output files see the section on {\hyperref[\detokenize{detexp:gen-freq}]{\sphinxcrossref{\DUrole{std,std-ref}{General frequency}}}}.

\end{fulllineitems}

\index{num\_den() (furs.furs method)@\spxentry{num\_den()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.num_den}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{num\_den}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Number density.

\sphinxAtStartPar
This function calculates the number density function \(n_{\mathrm{cl}}\) for the 2PACF defined in \sphinxcode{\sphinxupquote{acf()}}.

\sphinxAtStartPar
The array will also be saved as an \sphinxcode{\sphinxupquote{.npy}} format file in the path you gave during initialisation.


\subsection{Returns}
\label{\detokenize{api:id7}}\begin{description}
\sphinxlineitem{float}
\sphinxAtStartPar
Number of sources per pixel. It will be an array of length \(N_{\mathrm{pix}}\).

\end{description}

\end{fulllineitems}

\index{num\_sources() (furs.furs method)@\spxentry{num\_sources()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.num_sources}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{num\_sources}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
This function gives the total number of unresolved point sources on the full sky.

\sphinxAtStartPar
This is specifically for the flux density distribution defined in {\hyperref[\detokenize{api:furs.furs.dndS}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{dndS()}}}}},
and the minimum and maximum \(S\) values are set during the initialisation of the class object {\hyperref[\detokenize{api:module-furs}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{furs}}}}}.


\subsection{Returns}
\label{\detokenize{api:id8}}\begin{quote}

\sphinxAtStartPar
The total number of unresolved point sources. It is a pure number.
\end{quote}

\end{fulllineitems}

\index{print\_input() (furs.furs method)@\spxentry{print\_input()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.print_input}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{print\_input}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Print the input parameters you gave.

\end{fulllineitems}

\index{ref\_freq() (furs.furs method)@\spxentry{ref\_freq()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.ref_freq}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{ref\_freq}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Generates the brightness temperature and spectral indices at reference frequency.

\sphinxAtStartPar
3 output files are generated \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}}, \sphinxcode{\sphinxupquote{Tb\_o\_map.npy}} and \sphinxcode{\sphinxupquote{beta.npy}}

\sphinxAtStartPar
To understand the structure of these output files see the section on {\hyperref[\detokenize{detexp:ref-freq}]{\sphinxcrossref{\DUrole{std,std-ref}{Reference frequency}}}}.

\end{fulllineitems}

\index{visual() (furs.furs method)@\spxentry{visual()}\spxextra{furs.furs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:furs.furs.visual}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{visual}}}{\sphinxparam{\DUrole{n}{t\_skymap}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nu\_skymap}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{aps}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_skymap}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dndS\_plot}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{spectrum}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{antenna}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{xlog}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ylog}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{fig\_ext}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}pdf\textquotesingle{}}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Plotting function.

\sphinxAtStartPar
This function can produce several figures such as:\sphinxhyphen{}
\begin{itemize}
\item {} 
\sphinxAtStartPar
number density map

\item {} 
\sphinxAtStartPar
FURS map

\item {} 
\sphinxAtStartPar
angular power spectrum

\item {} 
\sphinxAtStartPar
flux density distribution function

\item {} 
\sphinxAtStartPar
sky averaged FURS as function of frequency

\item {} 
\sphinxAtStartPar
antenna temperature

\end{itemize}


\subsection{Parameters}
\label{\detokenize{api:id9}}\begin{description}
\sphinxlineitem{t\_skymap}{[}bool, optional{]}
\sphinxAtStartPar
Want to plot the FURS map (a Mollweide projection plot)? (Default = \sphinxcode{\sphinxupquote{False}}).

\sphinxlineitem{nu\_skymap}{[}float, optional{]}
\sphinxAtStartPar
Frequency in Hz at which you want to construct the FURS map. Relevant only when you give \sphinxcode{\sphinxupquote{t\_skymap = True}}.
(Default = \sphinxcode{\sphinxupquote{nu\_o}})

\sphinxlineitem{aps}{[}bool, optional{]}
\sphinxAtStartPar
Want to plot the angular power spectrum? (Default = \sphinxcode{\sphinxupquote{False}})

\sphinxlineitem{n\_skymap}{[}bool, optional{]}
\sphinxAtStartPar
Want to plot the number density map (a Mollweide projection plot)? (Default = \sphinxcode{\sphinxupquote{False}}).

\sphinxlineitem{dndS}{[}bool, optional{]}
\sphinxAtStartPar
Want to plot the flux density distribution? (Default = \sphinxcode{\sphinxupquote{False}}). The form of \(\mathrm{d}n/\mathrm{d}S\) is set during initialisation.

\sphinxlineitem{spectrum}{[}bool, optional{]}
\sphinxAtStartPar
Want to plot the sky averaged FURS? (Default = \sphinxcode{\sphinxupquote{True}}).

\sphinxlineitem{antenna}{[}bool, optional{]}
\sphinxAtStartPar
Add the antenna temperature? (Default = \sphinxcode{\sphinxupquote{False}}). You should have run {\hyperref[\detokenize{api:furs.furs.couple2D}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{couple2D()}}}}} to use this.

\sphinxlineitem{xlog}{[}bool, optional{]}
\sphinxAtStartPar
Set the x\sphinxhyphen{}axis scale of spectrum plot in log? (Default = \sphinxcode{\sphinxupquote{False}})

\sphinxlineitem{ylog}{[}bool, optional{]}
\sphinxAtStartPar
Set the y\sphinxhyphen{}axis scale of spectrum plot in log? (Default = \sphinxcode{\sphinxupquote{False}})

\sphinxlineitem{fig\_ext}{[}str, optional{]}
\sphinxAtStartPar
What should be the format of the figure files? Common choices include png, pdf or jpg. (Default = \sphinxcode{\sphinxupquote{pdf}})

\end{description}

\end{fulllineitems}


\end{fulllineitems}



\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{f}
\item\relax\sphinxstyleindexentry{furs}\sphinxstyleindexpageref{api:\detokenize{module-furs}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}
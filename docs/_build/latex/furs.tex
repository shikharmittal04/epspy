%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{furs}
\date{Mar 08, 2024}
\release{}
\author{Shikhar Mittal}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxstepscope


\chapter{Basics}
\label{\detokenize{basics:basics}}\label{\detokenize{basics::doc}}\begin{quote}\begin{description}
\sphinxlineitem{Name}
\sphinxAtStartPar
Foregrounds due to Unresolved Radio Sources

\sphinxlineitem{Author}
\sphinxAtStartPar
Shikhar Mittal

\sphinxlineitem{Homepage}
\sphinxAtStartPar
\sphinxurl{https://github.com/shikharmittal04/furs}

\end{description}\end{quote}


\section{Why do you need this code?}
\label{\detokenize{basics:why-do-you-need-this-code}}
\sphinxAtStartPar
Use this code to generate the Foregrounds due to
Unresolved Radio Sources (FURS).

\sphinxAtStartPar
A cosmological global 21\sphinxhyphen{}cm signal hides under foregrounds due to
galactic and extragalactic emissions. These foregrounds can easily be 4
to 5 orders of magnitude higher than the signal of interest. For a
reliable inference it is important to accurately model these
foregrounds. While we have a reasonable understanding of galactic
emission (typically fit as log\sphinxhyphen{}log polynomial), we do not understand the
extragalactic contributions. Based on existing models, this code models
the foregrounds due to unresolved extragalactic radio sources.

\sphinxAtStartPar
Read more about it in the paper \sphinxhref{https://arxiv.org/abs/2311.03447}{Mittal et al (2024)}.


\section{Installation and requirements}
\label{\detokenize{basics:installation-and-requirements}}
\sphinxAtStartPar
This package can be installed as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip\PYG{+w}{ }install\PYG{+w}{ }furs
\end{sphinxVerbatim}

\sphinxAtStartPar
It is recommended to work on a Python version \textgreater{} 3.8. Packages required are
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/numpy/}{numpy}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/scipy/}{scipy}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/matplotlib/}{matplotlib}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/mpi4py/}{mpi4py}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/healpy/}{healpy}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://pypi.org/project/transformcl/}{transformcl}

\end{itemize}


\section{Quick start}
\label{\detokenize{basics:quick-start}}
\sphinxAtStartPar
The code is run in two main steps:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Assign the unresolved sources flux densities (at a chosen reference frequency) and spectral indices.

\item {} 
\sphinxAtStartPar
Then generate the sky maps at desired frequencies of observation.

\end{itemize}

\sphinxAtStartPar
The following code captures the main functionalities of this package.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{furs} \PYG{k+kn}{import} \PYG{n}{furs}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}1 initialise the object with default settings}
\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}2 generate the data at the reference frequency}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{ref\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}3 generate the sky maps at multiple frequencies as well as their sky average}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{gen\PYGZus{}freq}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Step\PYGZhy{}4 finally, generate a sky averaged spectrum vs frequency figure}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{visual}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Save the above code as (say) \sphinxcode{\sphinxupquote{eg\_script.py}} and run it as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }eg\PYGZus{}script.py
\end{sphinxVerbatim}

\sphinxAtStartPar
Running the code will generate several files. The terminal messages will
guide you to these output files. The most important of all files of your
interest will be \sphinxcode{\sphinxupquote{Tb\_nu\_map.npy}}. However, you may never have to deal
with them yourself. To visualise your outputs use the function
\sphinxcode{\sphinxupquote{visual()}}. Read on to see the available features for \sphinxcode{\sphinxupquote{visual()}}.

\sphinxAtStartPar
The default values have been chosen such that the above script can be
run on a PC. Since modern PCs have at least 4 cores, for a better
performance one could also run the code as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
mpirun\PYG{+w}{ }\PYGZhy{}np\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }python\PYG{+w}{ }eg\PYGZus{}script.py
\end{sphinxVerbatim}

\sphinxAtStartPar
However, in general and for more realistic flux density ranges and high
resolution maps, it is recommended to run the code on HPCs.


\section{License and citation}
\label{\detokenize{basics:license-and-citation}}
\sphinxAtStartPar
The software is free to use on the MIT open source license. If you use the software for academic purposes then we request that you cite
the \sphinxhref{https://arxiv.org/abs/2311.03447}{Mittal et al (2024)}.

\sphinxstepscope


\chapter{Detailed explanation}
\label{\detokenize{detexp:detailed-explanation}}\label{\detokenize{detexp::doc}}

\section{Initialisation}
\label{\detokenize{detexp:initialisation}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{furs.furs()}} initialises the class object with default settings.
There are total 10 available optional arguments as follows:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nu\_o}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
reference frequency, \$nu\_0\$ (Hz)

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{150e6}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{beta\_o}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
mean spectral index, \$beta\_0\$

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{2.681}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{sigma\_beta}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
spread in the Gaussian distribution of spectral index,
\$sigma\_beta\$

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{0.5}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{amp}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
amplitude of the power\sphinxhyphen{}law 2\sphinxhyphen{}point angular correlation function
(2PACF), \$A\$. If you want to model a Poissonian distributed sky,
set this parameter to 0.

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{7.8e\sphinxhyphen{}3}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{gam}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
negative of the exponent of the 2PACF, \$gamma\$

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{0.821}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{logSmin}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\$log\_\{10\}(S\_\{mathrm\{min\}\})\$, where \$S\_\{mathrm\{min\}\}\$ is in
Jansky (Jy)

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{\sphinxhyphen{}2.0}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{logSmax}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\$log\_\{10\}(S\_\{mathrm\{max\}\})\$, where \$S\_\{mathrm\{max\}\}\$ is in
Jansky (Jy)

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{\sphinxhyphen{}1.0}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dndS\_form}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
sum of 2 double inverse power laws (0), 7th order log\sphinxhyphen{}log
polynomial (1) or 5th order log\sphinxhyphen{}log polynomial (2)

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{int}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{0}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{path}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
path where you would like to save all output files

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{string}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{‘’}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{log2Nside}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Number of divisions of each side of the pixel for \sphinxcode{\sphinxupquote{HEALPix}}
maps in units of log\_2

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{int}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{6}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{lbl}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
This is an additional label that you may want to append to the
output files

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{string}

\item {} 
\sphinxAtStartPar
default \sphinxstylestrong{‘’}

\end{itemize}

\end{enumerate}

\sphinxAtStartPar
Thus, if you want to chose a different set of parameters, you must
initialise the object as

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{obj = furs.furs(log2Nside=6, logSmin=\sphinxhyphen{}2,logSmax=\sphinxhyphen{}1,dndS\_form=0, nu\_o=150e6, beta\_o=2.681,sigma\_beta=0.5, amp=7.8e\sphinxhyphen{}3,gam=0.821, path=\textquotesingle{}\textquotesingle{}, lbl=\textquotesingle{}\textquotesingle{})}}

\sphinxAtStartPar
(Replace the above values by values of your choice.)


\section{Reference frequency}
\label{\detokenize{detexp:reference-frequency}}
\sphinxAtStartPar
The function \sphinxcode{\sphinxupquote{ref\_freq}} does 3 tasks:\sphinxhyphen{}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Calcuates the total number of unresolved sources corresponding to
your specified \sphinxcode{\sphinxupquote{logSmin}} and \sphinxcode{\sphinxupquote{logSmin}}.

\item {} 
\sphinxAtStartPar
Creates a ‘clustered’ sky density of unresolved radio sources,
fluctuation for which follows the 2PACF whose parameters are set by
\sphinxcode{\sphinxupquote{amp}} and \sphinxcode{\sphinxupquote{gam}}.

\item {} 
\sphinxAtStartPar
Finally, it visits each pixel on the sky and assigns each source a
flux density chosen from a flux distribution function,
:math: \sphinxtitleref{\textbackslash{}mathrm\{d\}n/\textbackslash{}mathrm\{d\}S} and a
spectral index which is normally distributed. The normal distribution
is set by \sphinxcode{\sphinxupquote{beta\_o}} and \sphinxcode{\sphinxupquote{sigma\_beta}}.

\end{itemize}

\sphinxAtStartPar
Sky pixelisation is set by \sphinxcode{\sphinxupquote{log2Nside}}. The number of pixels is
:math: \sphinxtitleref{N\_\{\textbackslash{}mathrm\{pix\}\} = 12 \textbackslash{}times 2\textasciicircum{}\{2k\}}, where :math: \sphinxtitleref{k=} \sphinxcode{\sphinxupquote{log2Nside}}.

\sphinxAtStartPar
The function does not return anything, but produces 4 output files,
namely \sphinxcode{\sphinxupquote{n\_clus.npy}}, \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}}, \sphinxcode{\sphinxupquote{Tb\_o\_map.npy}}, and
\sphinxcode{\sphinxupquote{beta.npy}} in the path specified by \sphinxcode{\sphinxupquote{path}} during initialisation.
The files are described below.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{n\_clus.npy}} is a 1D array which stores number density of
unresolved radio sources as number per pixel. \sphinxcode{\sphinxupquote{n\_clus{[}i{]}}} gives the
number of sources on the :math: \sphinxtitleref{i\textasciicircum{}\{\textbackslash{}mathrm\{th\}\}} pixel, where
:math: \sphinxtitleref{i=0,1,\textbackslash{}ldots,N\_\{\textbackslash{}mathrm\{pix\}\}\sphinxhyphen{}1}. Note that in general \sphinxcode{\sphinxupquote{n\_clus{[}i{]}}}
will not be a natural number; we simulate for a rounded\sphinxhyphen{}off value.

\item {} 
\sphinxAtStartPar
Both \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}} and \sphinxcode{\sphinxupquote{beta.npy}} are array of arrays of
unequal sizes and share equal amount of memory. Typically, these
files will be huge (for default settings they will of size \textasciitilde{} 17 MB
each). Each of \sphinxcode{\sphinxupquote{Tb\_o\_individual{[}0{]}}}, \sphinxcode{\sphinxupquote{Tb\_o\_individual{[}1{]}}}, …,
is an array and they are total \$N\_\{mathrm\{pix\}\}\$ in number
corresponding to :math: \sphinxtitleref{N\_\{\textbackslash{}mathrm\{pix\}\}} pixels. The last array is
\sphinxcode{\sphinxupquote{Tb\_o\_individual{[}Npix\sphinxhyphen{}1{]}}}. The length of array
\sphinxcode{\sphinxupquote{Tb\_o\_individual{[}i{]}}} is equal to the number of sources on the
\$i\textasciicircum{}\{mathrm\{th\}\}\$ pixel, which is \sphinxcode{\sphinxupquote{round(n\_clus{[}i{]})}}. The values
itself are the brightness temperature contributed by each source in
kelvin at reference frequency.

\item {} 
\sphinxAtStartPar
The structure of \sphinxcode{\sphinxupquote{beta}} is same as \sphinxcode{\sphinxupquote{Tb\_o\_individual}}. The values
itself are the spectral indices assigned to each source.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_o\_map}} is an array similar in structure to \sphinxcode{\sphinxupquote{n\_clus}}. It is
the pixel wise brightness temperature contributed by the
extragalactic radio sources at the reference frequency. Thus,
\sphinxcode{\sphinxupquote{Tb\_o\_map{[}i{]} = numpy.sum(Tb\_o\_individual{[}i{]})}}.

\end{enumerate}


\section{General frequency}
\label{\detokenize{detexp:general-frequency}}
\sphinxAtStartPar
The next important task is performed by the function \sphinxcode{\sphinxupquote{gen\_freq}}. It
scales the brightness temperature at reference frequency for each source
according to a power law to a desired range of frequencies. The desired
frequencies should be supplied (in Hz) as a numpy array to this
function. For example

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{gen\PYGZus{}freq}\PYG{p}{(}\PYG{n}{nu} \PYG{o}{=} \PYG{l+m+mf}{1e6}\PYG{o}{*}\PYG{n}{numpy}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+m+mi}{201}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The default value is as given in the above command. This function does
not return anything but produces 3 files namely \sphinxcode{\sphinxupquote{Tb\_nu\_map.npy}},
\sphinxcode{\sphinxupquote{Tb\_nu\_glob.npy}}, and \sphinxcode{\sphinxupquote{nu\_glob.npy}} in the path specified by
\sphinxcode{\sphinxupquote{path}} during initialisation. The files are described below.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_nu\_map}} is a 2D array of shape :math: \sphinxtitleref{N\_\{\textbackslash{}mathrm\{pix\}\}\textbackslash{}times
N\_\{\textbackslash{}nu\}}, so that \sphinxcode{\sphinxupquote{Tb\_nu\_map{[}i,j{]}}} gives the brightness temperature
on the :math: \sphinxtitleref{i\textasciicircum{}\{\textbackslash{}mathrm\{th\}\}} pixel at \sphinxcode{\sphinxupquote{nu{[}j{]}}} frequency. :math: \sphinxtitleref{N\_\{\textbackslash{}nu\}} is
the number of frequencies you gave in the argument of \sphinxcode{\sphinxupquote{gen\_freq()}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_nu\_glob}} is derived directly from \sphinxcode{\sphinxupquote{Tb\_nu\_map}}. It is the sky
average of the map at each frequency and is thus a 1D array. It is
calculated as \sphinxcode{\sphinxupquote{Tb\_nu\_glob = numpy.mean(Tb\_nu\_map,axis=0)}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nu\_glob.npy}} is simply the frequency array you gave else it is the
default value.

\end{enumerate}

\sphinxAtStartPar
Note that this function loads \sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}} and \sphinxcode{\sphinxupquote{beta.npy}}.
These files can easily be 10s of GB in size for ‘realistic’ \sphinxcode{\sphinxupquote{logSmin}}
and \sphinxcode{\sphinxupquote{logSmax}}. Common personal computers have \textasciitilde{} 4 GB RAM. It is thus
recommended to run this code on supercomputers. For job submission scipt
users are requested to specify \sphinxcode{\sphinxupquote{\#SBATCH \sphinxhyphen{}\sphinxhyphen{}mem\sphinxhyphen{}per\sphinxhyphen{}cpu={[}size in MB{]}}},
where a recommendation for \sphinxcode{\sphinxupquote{size in MB}} will be printed by
\sphinxcode{\sphinxupquote{ref\_freq()}} function.


\section{Chromatic distortions}
\label{\detokenize{detexp:chromatic-distortions}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tb\_nu\_map}} and hence \sphinxcode{\sphinxupquote{Tb\_nu\_glob}} so generated do NOT account for
chromatic distortions. They are simply the model outputs for foregrounds
due to unresolved radio sources. However, in reality because of the
chromatic nature of the antenna beam the actual foregrounds spectrum
registered will be different. You can use the function
\sphinxcode{\sphinxupquote{chromatisize()}} to account for the chromaticity.

\sphinxAtStartPar
Since this is experiment specific you will need to provide an external
data file: the beam directivity pattern, :math: \sphinxtitleref{D}. This should be a 2D array
of shape :math: \sphinxtitleref{N\_\{\textbackslash{}mathrm\{pix\}\}\textbackslash{}times N\_\{\textbackslash{}nu\}}, such that \sphinxcode{\sphinxupquote{D{[}i,j{]}}} should
give the beam directivity at \$i\textasciicircum{}\{mathrm\{th\}\}\$ pixel at nu{[}j{]} frequency.
The frequencies at which you generate your data :math: \sphinxtitleref{D} should be the same
as the frequencies you gave in \sphinxcode{\sphinxupquote{gen\_freq()}}. (In case you forgot,
\sphinxcode{\sphinxupquote{gen\_freq()}} will have saved the frequecy array in your \sphinxcode{\sphinxupquote{obj.path}}
path.) Put this array :math: \sphinxtitleref{D} in your \sphinxcode{\sphinxupquote{obj.path}} path by the name of
\sphinxcode{\sphinxupquote{D.npy}}.

\sphinxAtStartPar
Only after running \sphinxcode{\sphinxupquote{ref\_freq}} and \sphinxcode{\sphinxupquote{gen\_freq}}, run \sphinxcode{\sphinxupquote{chromatisize}}
as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{chromatisize}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
No input argument is required. The return value is \sphinxcode{\sphinxupquote{None}}. This
function will generate a file called \sphinxcode{\sphinxupquote{T\_data.npy}} in your path. This
will be a 1D array with length of number of frequencies.


\section{Visualisation}
\label{\detokenize{detexp:visualisation}}
\sphinxAtStartPar
The final part of the code is to visualise the results. Main data for
inspection is in the file \sphinxcode{\sphinxupquote{Tb\_nu\_map.npy}}. Each of \sphinxcode{\sphinxupquote{Tb\_nu\_map{[}:,j{]}}}
is an array in the standard ring ordered \sphinxcode{\sphinxupquote{HEALPix}} format and is thus
ready for visualisation as a Mollweide projection. You may also be
interested in inspecting the global spectrum of extragalactic emission,
i.e, temperature as a function of frequency. This is simply the data in
the file \sphinxcode{\sphinxupquote{Tb\_nu\_glob.npy}} generated by \sphinxcode{\sphinxupquote{gen\_freq()}}.

\sphinxAtStartPar
You may use the function \sphinxcode{\sphinxupquote{visual()}} for both the above purposes. It is
possible to make several other additional figures by simply setting the
optional arguments to \sphinxcode{\sphinxupquote{True}} (see below). This function is again a
method of class object \sphinxcode{\sphinxupquote{furs}} and is thus called as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{o}{.}\PYG{n}{furs}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{obj}\PYG{o}{.}\PYG{n}{visual}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The following optional arguments are available for this function:\sphinxhyphen{}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nu\_skymap}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
the frequency at which you want to produce a Mollweide projection
of extragalactic foregrounds

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{float}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{nu\_o}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{t\_skymap}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Create a sky map of extragalactic foregrounds?

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{False}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{n\_skymap}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Create a sky map of number density of unresolved radio sources?

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{False}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dndS\_plot}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Plot the \$S\$ distribution function?

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{False}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{aps}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Plot the angular power spectrum?

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{False}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{spectrum}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Create the foreground spectrum?

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{True}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{chromatic}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
To the spectrum figure add the sky data curve which accounts for
beam chromaticity?

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{False}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{xlog}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Set x\sphinxhyphen{}axis in log scale? This and the next option are relevant
only for the spectrum plot.

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{False}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ylog}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Set y\sphinxhyphen{}axis in log scale?

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{bool}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{True}}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{fig\_ext}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Choose your format of figure file; popular choices include
\sphinxcode{\sphinxupquote{pdf}}, \sphinxcode{\sphinxupquote{jpeg}}, \sphinxcode{\sphinxupquote{png}}

\item {} 
\sphinxAtStartPar
type \sphinxstyleemphasis{string}

\item {} 
\sphinxAtStartPar
default \sphinxcode{\sphinxupquote{pdf}}

\end{itemize}

\end{enumerate}

\sphinxAtStartPar
This function will produce figures in the path specficied during
initialisation.

\sphinxstepscope


\chapter{Other functions}
\label{\detokenize{otherfuncs:other-functions}}\label{\detokenize{otherfuncs::doc}}
\sphinxAtStartPar
There are 5 additional useful methods of the class \sphinxcode{\sphinxupquote{furs}}. These are:\sphinxhyphen{}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{acf(chi)}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
returns the 2PACF, \$C(chi)\$

\item {} 
\sphinxAtStartPar
requires one argument, the angle \$chi\$ in radians; can be a
number or an array

\item {} 
\sphinxAtStartPar
output is a dimensionless quantity

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dndS(S)}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
returns flux distribution, \$mathrm\{d\}n/mathrm\{d\}S\$. The
functional form will be according to your choice for \sphinxcode{\sphinxupquote{dndS\_form}}
you gave during initialisation. Default is 0.

\item {} 
\sphinxAtStartPar
requires one argument, the flux density \$S\$ in Jy; can be a number
or an array

\item {} 
\sphinxAtStartPar
output is in units of number per unit flux density per unit solid
angle, i.e. \$mathrm\{Jy\textasciicircum{}\{\sphinxhyphen{}1\}sr\textasciicircum{}\{\sphinxhyphen{}1\}\}\$

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{num\_den()}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
returns the clustered number density as number per pixel,
\$n\_\{mathrm\{clus\}\}\$

\item {} 
\sphinxAtStartPar
no arguments required

\item {} 
\sphinxAtStartPar
output is an array of length \$N\_\{mathrm\{pix\}\}\$

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{num\_sources()}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
returns the total number of unresolved extragalactic radio sources
for the full sky, \$N\_\{mathrm\{s\}\}\$

\item {} 
\sphinxAtStartPar
no arguments required

\item {} 
\sphinxAtStartPar
output is a pure number

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{print\_input()}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
If you want to print the all raw parameter values you gave, you
may use this function to print them

\item {} 
\sphinxAtStartPar
no arguments required

\item {} 
\sphinxAtStartPar
no return value

\end{itemize}

\end{enumerate}

\sphinxAtStartPar
Example usage: to find the number of sources between \$10\textasciicircum{}\{\sphinxhyphen{}6\}\$ and
\$10\textasciicircum{}\{\sphinxhyphen{}1\}mathrm\{Jy\}\$ do

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{obj} \PYG{o}{=} \PYG{n}{furs}\PYG{p}{(}\PYG{n}{logSmin}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{n}{logSmax}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{Ns} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{num\PYGZus{}sources}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{General remarks}
\label{\detokenize{genrem:general-remarks}}\label{\detokenize{genrem::doc}}
\sphinxAtStartPar
Users do not have to run \sphinxcode{\sphinxupquote{ref\_freq()}} everytime. If they want to use
the same data for source distribution (\sphinxcode{\sphinxupquote{n\_clus.npy}}), flux density
(\sphinxcode{\sphinxupquote{Tb\_o\_individual.npy}}) and spectral index (\sphinxcode{\sphinxupquote{beta.npy}}) assignments
at reference frequency to generate spectrum and sky maps for a different
frequency range, then run only \sphinxcode{\sphinxupquote{gen\_freq()}} for a new choice of
\sphinxcode{\sphinxupquote{nu}}.

\sphinxAtStartPar
Similarly, if you have already run \sphinxcode{\sphinxupquote{gen\_freq()}} and are happy with the
specifications of the model then you can directly jump to the
\sphinxcode{\sphinxupquote{visual()}} function.

\sphinxAtStartPar
In case you forgot what data set you generated with what specifications,
you can always save your class object using the function
\sphinxcode{\sphinxupquote{save\_furs(class\_object,\textquotesingle{}file\_name.pkl\textquotesingle{})}} in the directory where all
other outputs are saved and load back using \sphinxcode{\sphinxupquote{load\_furs}}. (Both
functions are part of module \sphinxcode{\sphinxupquote{furs.py}}.)

\sphinxAtStartPar
Thus, after initialising your class object (i.e.
\sphinxcode{\sphinxupquote{obj = furs({[}YOUR SPECIFICATIONS{]})}}), you can add to your script

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{furs}\PYG{o}{.}\PYG{n}{save\PYGZus{}furs}\PYG{p}{(}\PYG{n}{obj}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{myobj.pkl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
So when you came back next time you can load it as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{obj}\PYG{o}{=}\PYG{n}{furs}\PYG{o}{.}\PYG{n}{load\PYGZus{}furs}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/give/full/path/to/myobj.pkl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
You can check that indeed the specfications are correctly loaded by
printing them via command \sphinxcode{\sphinxupquote{obj.print\_input()}}.



\renewcommand{\indexname}{Index}
\printindex
\end{document}